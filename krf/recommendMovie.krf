(in-microtheory Movie-Recommender)

;;; recommendMovieName

(<== (recommendMovieName ?inputMovieName ?recommendedMovieName)
  (movieTitleString ?inputMovie ?inputMovieName)
  (movieTitleString ?recommendedMovie ?recommendedMovieName)
  (movieAdvisoryRating ?inputMovie ?rating)
  (recommendMovie ?inputMovie ?recommendedMovie)
  (similarMovie ?inputMovie ?recommendedMovie ?rating)
  (different ?inputMovie ?recommendedMovie)
)

(<== (recommendMovieName ?inputMovieName ?recommendedMovieName ?rating)
  (movieTitleString ?inputMovie ?inputMovieName)
  (movieTitleString ?recommendedMovie ?recommendedMovieName)
  (recommendMovie ?inputMovie ?recommendedMovie)
  (similarMovie ?inputMovie ?recommendedMovie ?rating)
  (different ?inputMovie ?recommendedMovie)
)

;;; recommendMovie

(<== (recommendMovie ?inputMovie ?recommendedMovie)
  (fanFavorite ?inputMovie ?recommendedMovie)
)

(<== (recommendMovie ?inputMovie ?recommendedMovie)
  (criticFavorite ?inputMovie ?recommendedMovie)
)

(<== (recommendMovie ?inputMovie ?recommendedMovie)
  (academyFavorite ?inputMovie ?recommendedMovie)
)

(<== (recommendMovie ?inputMovie ?recommendedMovie)
  (oldies ?inputMovie ?recommendedMovie)
)

(<== (recommendMovie ?inputMovie ?recommendedMovie)
  (hiddenGems ?inputMovie ?recommendedMovie)
)

(<== (recommendMovie ?inputMovie ?recommendedMovie)
  (foreignLanguage ?inputMovie ?recommendedMovie)
)

;;; recommendation types

(<== (criticFavorite ?inputMovie ?criticMovie)
  (movieMetascore ?criticMovie ?score)
  (greaterThan ?score 85)
)

(<== (fanFavorite ?inputMovie ?fanFavMovie)

  (movieMetascore ?fanFavMovie ?score)
  (greaterThan 65 ?score)

  (movieImdbRatingCount ?fanFavMovie ?numRev)
  (greaterThan ?numRev 10000)
)

(<== (academyFavorite ?inputMovie ?academyMovie)
 (movieAwardWon ?academyMovie)
 (movieMetascore ?academyMovie ?score)
 (greaterThan ?score 80)
)

(<== (oldies ?inputMovie ?oldMovie)
 (sameAdvisoryRating ?oldMovie)
 (sameDirectorOrGenre ?inputMovie ?oldMovie)
 (movieDecade ?oldMovie ?decade)
 (lessThan ?decade 1980)
)

;;; presets: 70% minimum score, 5,000 max reviews
(<== (hiddenGems ?inputMovie ?hiddenGemMovie)
 (movieMetascore ?hiddenGemMovie ?score)
 (lessThan 70 ?score)
 (movieImdbRatingCount ?hiddenGemMovie ?numRevs)
 (greaterThan 5000 ?numRevs)
)

;(<== (newRating ?inputMovie ?newRatingMovie)
; (movieAdvisoryRating ?inputMovie)
; (different ?newRating)
;)

(<== (foreignLanguage ?inputMovie ?foreignLanguageMovie)
 (movieLanguage ?foreignLanguageMovie ?language)
 (different ?language English)
)

;;; similarMovie

(<== (similarMovie ?inputMovie ?outputMovie ?rating)
  (sameDecade ?inputMovie ?outputMovie)
  (movieAdvisoryRating ?outputMovie ?rating)
  (sameDirectorOrGenre ?inputMovie ?outputMovie)
)

(<== (sameDirectorOrGenre ?movie1 ?movie2)
  (sameGenre ?movie1 ?movie2)
)

(<== (sameDirectorOrGenre ?movie1 ?movie2)
  (sameDirector ?movie1 ?movie2)
)

;;; same things

(<== (sameDecade ?movie1 ?movie2)
  (movieDecade ?movie1 ?decade)
  (movieDecade ?movie2 ?decade)
)

(<== (sameGenre ?movie1 ?movie2)
  (movieGenres ?movie1 ?genre)
  (movieGenres ?movie2 ?genre)
)

(<== (sameGenres ?movie1 ?movie2)
  (evaluate ?movieGenres1
     (TheClosedRetrievalSetOf ?genre
         (movieGenres ?movie1 ?genre)))
  (evaluate ?movieGenres2
     (TheClosedRetrievalSetOf ?genre
         (movieGenres ?movie2 ?genre)))
  (equals ?movieGenres1 ?movieGenres2))

(<== (same2Genres ?movie ?movie2)
  (movieGenres ?movie1 ?genre1)
  (movieGenres ?movie2 ?genre1)
  (movieGenres ?movie1 ?genre2)
  (movieGenres ?movie2 ?genre2))

(<== (sameDirector ?movie1 ?movie2)
  (movieDirector ?movie1 ?director)
  (movieDirector ?movie2 ?director)
)

(<== (sameAdvisoryRating ?movie1 ?movie2)
  (movieAdvisoryRating ?movie1 ?rating)
  (movieAdvisoryRating ?movie2 ?rating)
)

(<== (sameActors ?movie1 ?movie2)
  (movieActors ?movie1 ?actor)
  (movieActors ?movie2 ?actor)
)

;;; (recommend ?movie ?criteria ?result)
;;; (elementOf ?c1 ?criteria)
;;; (unifies ?c1 fanFav)
;;; (fanFav ?movie ?movieList ?result)

;;; gets all of the bindings for fanFav
;;; (closedRetrieval ?result SetOf (fanFav ?movie ?movieList ?result))

;;; make sure that movie results are reasonable, be able to combine queries

;;; unifies ?something ?wholePredicate | this would allow us to compose things
